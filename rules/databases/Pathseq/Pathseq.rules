db_path=config["pathseq_database"]
rule all_PathseqDB:
    input: "PathseqDB/pathseq_host.fa.fai",
           "PathseqDB/pathseq_host.fa",
           "PathseqDB/pathseq_host.bfi",
           "PathseqDB/pathseq_host.fa.img",
           "PathseqDB/pathseq_host.dict",
           "PathseqDB/pathseq_microbe.fa.fai",
           "PathseqDB/pathseq_microbe.fa",
           "PathseqDB/pathseq_microbe.fa.img",
           "PathseqDB/pathseq_microbe.dict",
           "PathseqDB/pathseq_taxonomy.db"


rule download_Pathseq_DB_from_ftp:
    output: "{filename}.gz",

    params: dir=db_path

    shell:
        """
        cd {params.dir}
        mkdir PathseqDB
        wget ftp://gsapubftp-anonymous@ftp.broadinstitute.org/bundle/pathseq/{wildcards.filename}.gz -P PathseqDB
        """

rule decompress_host_DB:
    input: "PathseqDB/pathseq_host.tar.gz"

    output: "PathseqDB/pathseq_host.fa.fai",
            "PathseqDB/pathseq_host.fa",
            "PathseqDB/pathseq_host.bfi",
            "PathseqDB/pathseq_host.fa.img",
            "PathseqDB/pathseq_host.dict"

    shell: "tar -I pigz -xvf {input} -C PathseqDB"

rule decompress_microbe_DB:
    input: "PathseqDB/pathseq_microbe.tar.gz"

    output: "PathseqDB/pathseq_microbe.fa.fai",
            "PathseqDB/pathseq_microbe.fa",
            "PathseqDB/pathseq_microbe.fa.img",
            "PathseqDB/pathseq_microbe.dict"


    shell: "tar -I pigz -xvf {input} -C PathseqDB"

rule decompress_taxonomy_DB:
    input: "PathseqDB/pathseq_taxonomy.tar.gz"

    output: "PathseqDB/pathseq_taxonomy.db"

    shell: "tar -I pigz -xvf {input} -C PathseqDB"


