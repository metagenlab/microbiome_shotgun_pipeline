surpi_db=config["surpi_database"]

rule all_surpi_db:
    input: f"{surpi_db}/build/nt_curated.fa"


rule clone_surpi_repo:
    singularity: "library://fchaaban/default/surpi:1.0.0"

    output: f"{surpi_db}/Makefile"

    params: DB_path=surpi_db

    shell:
        """
        cp -r /scif/apps/SURPI/SURPI/etc/reference/* {params.DB_path}
        """

rule build_surpi_database:
    singularity: "library://fchaaban/default/surpi:1.0.0"

    input: f"{surpi_db}/Makefile"

    output: f"{surpi_db}/build/nt_curated.fa"

    params: DB_path=surpi_db

    shell:
        """
        bash -c "make -C {params.DB_path} all"
        """
