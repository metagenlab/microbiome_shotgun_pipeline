
rule cat_bat_contigs:
    conda:
        "../../envs/cat_bat.yml"
    singularity:
        "docker://quay.io/biocontainers/cat:5.0.3--0"
    threads:
        50
    input:
        "samples/{sample}/assembly/spades/large_contigs_edit.fasta",
        "samples/{sample}/gene_call/{sample}.faa",
    output:
        "samples/{sample}/contigs_classification/cat_bat/out.CAT.ORF2LCA.txt",
        "samples/{sample}/contigs_classification/cat_bat/out.CAT.contig2classification.txt",
    shell:
        '''
        mkdir $(dirname output[0])
        CAT contigs -c {input[0]} -d databases/cat_bat/CAT_database/ -t databases/cat_bat/CAT_taxonomy/ -p {input[1]} --tmpdir $(dirname {output[0]}) --nproc {threads} -o $(dirname {output[0]})/out.CAT
        '''
