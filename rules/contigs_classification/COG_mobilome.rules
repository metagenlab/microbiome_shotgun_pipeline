rule rpsblast_COG_mobilome:
    conda:
        "../../envs/hmmer.yml"
    singularity:
        "docker://quay.io/biocontainers/blast:2.9.0--pl526h3066fca_4"
    input:
        "samples/{sample}/gene_call/{sample}.faa"
    threads:
        8
    output:
        "samples/{sample}/contigs_classification/COG_mobilome/{sample}.tsv"
    shell:
        """
        rpsblast -db databases/cdd/COG_mobilome/Cog_mobilome -query {input[0]} -outfmt 6 -evalue 0.001 -num_threads {threads} > {output[0]}
        """
